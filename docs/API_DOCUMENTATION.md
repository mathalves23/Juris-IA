# üìö DOCUMENTA√á√ÉO COMPLETA DA API - JURISSAAS

## üìã Vis√£o Geral

A API do JurisSaaS √© uma API RESTful que fornece funcionalidades completas para gerenciamento de documentos jur√≠dicos, templates inteligentes, an√°lise por IA e muito mais.

### üîó URL Base
```
https://api.jurissaas.com/api
```

### üìä Vers√£o da API
```
v1.0
```

### üîê Autentica√ß√£o
A API utiliza **JWT (JSON Web Tokens)** para autentica√ß√£o. Inclua o token no header de todas as requisi√ß√µes protegidas:

```http
Authorization: Bearer <seu_jwt_token>
```

## üîë Autentica√ß√£o

### POST /auth/register
Registrar novo usu√°rio

**Request:**
```json
{
  "nome": "Jo√£o Silva",
  "email": "joao@escritorio.com",
  "senha": "MinhaSenh@123"
}
```

**Response (201):**
```json
{
  "message": "Usu√°rio criado com sucesso",
  "user_id": 123
}
```

**Valida√ß√µes:**
- Nome: 2-100 caracteres
- Email: formato v√°lido e √∫nico
- Senha: m√≠nimo 8 caracteres, incluindo mai√∫scula, min√∫scula e n√∫mero

### POST /auth/login
Realizar login

**Request:**
```json
{
  "email": "joao@escritorio.com",
  "senha": "MinhaSenh@123"
}
```

**Response (200):**
```json
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "user": {
    "id": 123,
    "nome": "Jo√£o Silva",
    "email": "joao@escritorio.com",
    "foto_url": null,
    "created_at": "2024-01-15T10:30:00Z"
  },
  "expires_in": 3600
}
```

### POST /auth/refresh
Renovar token de acesso

**Headers:**
```http
Authorization: Bearer <refresh_token>
```

**Response (200):**
```json
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "expires_in": 3600
}
```

### GET /auth/me
Obter dados do usu√°rio autenticado

**Headers:**
```http
Authorization: Bearer <access_token>
```

**Response (200):**
```json
{
  "id": 123,
  "nome": "Jo√£o Silva",
  "email": "joao@escritorio.com",
  "foto_url": "https://example.com/foto.jpg",
  "created_at": "2024-01-15T10:30:00Z",
  "last_login": "2024-01-20T14:30:00Z",
  "subscription": {
    "plan": "premium",
    "expires_at": "2024-12-31T23:59:59Z",
    "features": ["ai_analysis", "unlimited_templates", "export_pdf"]
  }
}
```

### PUT /auth/me
Atualizar perfil do usu√°rio

**Request:**
```json
{
  "nome": "Jo√£o Santos Silva",
  "foto_url": "https://example.com/nova-foto.jpg"
}
```

**Response (200):**
```json
{
  "message": "Perfil atualizado com sucesso",
  "user": {
    "id": 123,
    "nome": "Jo√£o Santos Silva",
    "email": "joao@escritorio.com",
    "foto_url": "https://example.com/nova-foto.jpg"
  }
}
```

## üìÑ Documentos

### GET /documents
Listar documentos do usu√°rio

**Query Parameters:**
- `page` (opcional): P√°gina (padr√£o: 1)
- `per_page` (opcional): Itens por p√°gina (padr√£o: 20, m√°ximo: 100)
- `search` (opcional): Busca por t√≠tulo ou conte√∫do
- `status` (opcional): Filtrar por status (rascunho, finalizado, arquivado)
- `template_id` (opcional): Filtrar por template
- `sort` (opcional): Ordena√ß√£o (created_at, updated_at, titulo)
- `order` (opcional): Dire√ß√£o (asc, desc)

**Response (200):**
```json
{
  "documents": [
    {
      "id": 456,
      "titulo": "Contrato de Presta√ß√£o de Servi√ßos",
      "status": "finalizado",
      "template_id": 789,
      "template_titulo": "Contrato Padr√£o",
      "created_at": "2024-01-15T10:30:00Z",
      "updated_at": "2024-01-16T15:45:00Z",
      "word_count": 1250,
      "ai_score": 0.85
    }
  ],
  "pagination": {
    "page": 1,
    "pages": 5,
    "per_page": 20,
    "total": 95
  },
  "stats": {
    "total_documents": 95,
    "drafts": 12,
    "completed": 78,
    "archived": 5
  }
}
```

### POST /documents
Criar novo documento

**Request:**
```json
{
  "titulo": "Novo Contrato",
  "conteudo": "Conte√∫do do documento...",
  "template_id": 789,
  "status": "rascunho",
  "metadata": {
    "client_name": "Empresa XYZ",
    "contract_type": "service",
    "value": 15000.00
  }
}
```

**Response (201):**
```json
{
  "id": 457,
  "titulo": "Novo Contrato",
  "status": "rascunho",
  "created_at": "2024-01-20T16:00:00Z",
  "validation": {
    "valid": true,
    "score": 0.78,
    "warnings": ["Adicionar cl√°usula de foro"],
    "errors": []
  }
}
```

### GET /documents/{id}
Obter documento espec√≠fico

**Response (200):**
```json
{
  "id": 456,
  "titulo": "Contrato de Presta√ß√£o de Servi√ßos",
  "conteudo": "Conte√∫do completo do documento...",
  "status": "finalizado",
  "template_id": 789,
  "user_id": 123,
  "created_at": "2024-01-15T10:30:00Z",
  "updated_at": "2024-01-16T15:45:00Z",
  "metadata": {
    "client_name": "Empresa XYZ",
    "contract_type": "service",
    "value": 15000.00,
    "ai_analysis": {
      "score": 0.85,
      "risks": ["baixo"],
      "suggestions": ["Revisar cl√°usula de pagamento"]
    }
  }
}
```

### PUT /documents/{id}
Atualizar documento

**Request:**
```json
{
  "titulo": "Contrato Atualizado",
  "conteudo": "Novo conte√∫do...",
  "status": "finalizado"
}
```

**Response (200):**
```json
{
  "message": "Documento atualizado com sucesso",
  "validation": {
    "valid": true,
    "score": 0.82,
    "changes_detected": ["content", "status"]
  }
}
```

### DELETE /documents/{id}
Excluir documento

**Response (200):**
```json
{
  "message": "Documento exclu√≠do com sucesso"
}
```

## üìã Templates

### GET /templates
Listar templates

**Query Parameters:**
- `page`, `per_page`: Pagina√ß√£o
- `search`: Busca textual
- `category`: Filtrar por categoria
- `complexity`: Filtrar por complexidade (basico, intermediario, avancado)
- `legal_area`: Filtrar por √°rea jur√≠dica
- `public_only`: Mostrar apenas templates p√∫blicos (boolean)

**Response (200):**
```json
{
  "templates": [
    {
      "id": 789,
      "titulo": "Contrato de Presta√ß√£o de Servi√ßos",
      "categoria": "contratos_civil",
      "publico": true,
      "autor": "Sistema",
      "rating": 4.5,
      "usage_count": 234,
      "created_at": "2024-01-01T00:00:00Z",
      "metadata": {
        "complexity": "intermediario",
        "legal_area": "civil",
        "estimated_time": 30,
        "tags": ["contrato", "servicos", "civil"]
      },
      "preview": "CONTRATO DE PRESTA√á√ÉO DE SERVI√áOS..."
    }
  ],
  "pagination": {
    "page": 1,
    "pages": 8,
    "per_page": 20,
    "total": 156
  }
}
```

### POST /templates
Criar novo template

**Request:**
```json
{
  "titulo": "Meu Template Personalizado",
  "conteudo": "CONTRATO DE {{TIPO}}\n\nCONTRATANTE: {{NOME_CONTRATANTE}}...",
  "categoria": "contratos_civil",
  "publico": false,
  "metadata": {
    "complexity": "basico",
    "legal_area": "civil",
    "tags": ["contrato", "personalizado"],
    "required_fields": ["TIPO", "NOME_CONTRATANTE", "NOME_CONTRATADO"],
    "estimated_time": 15
  }
}
```

**Response (201):**
```json
{
  "id": 790,
  "message": "Template criado com sucesso",
  "variables_detected": ["TIPO", "NOME_CONTRATANTE", "NOME_CONTRATADO"],
  "quality_score": 0.78,
  "validation": {
    "valid": true,
    "warnings": ["Considere adicionar cl√°usula de foro"]
  }
}
```

### POST /templates/{id}/generate
Gerar documento a partir de template

**Request:**
```json
{
  "variables": {
    "TIPO": "Consultoria Jur√≠dica",
    "NOME_CONTRATANTE": "Jo√£o Silva",
    "NOME_CONTRATADO": "Escrit√≥rio ABC",
    "VALOR": 5000.00,
    "PRAZO": "60 dias"
  },
  "auto_save": true
}
```

**Response (200):**
```json
{
  "content": "CONTRATO DE CONSULTORIA JUR√çDICA\n\nCONTRATANTE: Jo√£o Silva...",
  "document_id": 458,
  "validation": {
    "valid": true,
    "quality_score": 0.89,
    "missing_fields": [],
    "suggestions": ["Revisar valores monet√°rios"]
  }
}
```

## ü§ñ Intelig√™ncia Artificial

### POST /ai/analyze
Analisar documento com IA

**Request:**
```json
{
  "content": "Conte√∫do do documento para an√°lise...",
  "document_type": "contrato",
  "legal_area": "civil",
  "analysis_depth": "detailed"
}
```

**Response (200):**
```json
{
  "analysis": {
    "overall_score": 0.82,
    "structure_score": 0.85,
    "legal_compliance": 0.80,
    "risk_assessment": "medium",
    "suggestions": [
      {
        "type": "improvement",
        "priority": "high",
        "description": "Adicionar cl√°usula de resolu√ß√£o de conflitos",
        "location": "section_6"
      }
    ],
    "identified_clauses": [
      {
        "type": "payment",
        "content": "Pagamento em 30 dias",
        "status": "valid"
      }
    ],
    "missing_clauses": ["foro", "vigencia"],
    "legal_references": [
      {
        "law": "C√≥digo Civil",
        "article": "Art. 421",
        "relevance": "high"
      }
    ]
  },
  "processing_time": 2.3
}
```

### POST /ai/suggest-clauses
Sugerir cl√°usulas para documento

**Request:**
```json
{
  "document_type": "contrato",
  "legal_area": "trabalhista",
  "existing_content": "Conte√∫do parcial do documento...",
  "context": {
    "contract_value": 50000,
    "duration": "12 meses",
    "parties": ["employer", "employee"]
  }
}
```

**Response (200):**
```json
{
  "suggestions": [
    {
      "clause_type": "rescission",
      "title": "Cl√°usula de Rescis√£o",
      "content": "O presente contrato poder√° ser rescindido...",
      "importance": "essential",
      "legal_basis": "CLT Art. 482"
    }
  ],
  "priority_clauses": ["rescission", "payment", "obligations"],
  "estimated_completion": 0.75
}
```

### POST /ai/legal-research
Pesquisa jur√≠dica assistida por IA

**Request:**
```json
{
  "query": "Responsabilidade civil por danos morais",
  "legal_area": "civil",
  "jurisdiction": "brasil",
  "depth": "comprehensive"
}
```

**Response (200):**
```json
{
  "research": {
    "summary": "Resumo da pesquisa sobre responsabilidade civil...",
    "key_concepts": ["dano moral", "nexo causal", "culpa"],
    "legislation": [
      {
        "law": "C√≥digo Civil",
        "articles": ["Art. 186", "Art. 927"],
        "summary": "Fundamentos da responsabilidade civil"
      }
    ],
    "jurisprudence": [
      {
        "court": "STJ",
        "case": "REsp 1.234.567",
        "summary": "Precedente importante sobre danos morais",
        "date": "2023-05-15"
      }
    ],
    "recommendations": [
      "Analisar nexo causal",
      "Quantificar danos",
      "Verificar excludentes de responsabilidade"
    ]
  }
}
```

## üì§ Upload e Exporta√ß√£o

### POST /upload/document
Upload de documento para an√°lise

**Request (multipart/form-data):**
```
file: [arquivo.pdf/.docx/.txt]
document_type: "contrato"
auto_analyze: true
```

**Response (200):**
```json
{
  "file_id": "uuid-file-id",
  "original_name": "contrato.pdf",
  "file_size": 245760,
  "extracted_text": "Texto extra√≠do do documento...",
  "document_created": true,
  "document_id": 459,
  "analysis": {
    "confidence": 0.92,
    "detected_type": "contrato_prestacao_servicos",
    "suggestions": ["Revisar formata√ß√£o"]
  }
}
```

### GET /export/document/{id}
Exportar documento

**Query Parameters:**
- `format`: pdf, docx, txt, html (padr√£o: pdf)
- `template`: layout de exporta√ß√£o
- `watermark`: adicionar marca d'√°gua (boolean)

**Response (200):**
```
Content-Type: application/pdf
Content-Disposition: attachment; filename="documento.pdf"

[Binary content]
```

## üìä Analytics e Relat√≥rios

### GET /analytics/dashboard
Dashboard de analytics do usu√°rio

**Response (200):**
```json
{
  "period": "last_30_days",
  "stats": {
    "documents_created": 15,
    "templates_used": 8,
    "ai_analyses": 12,
    "export_count": 25
  },
  "trends": {
    "documents_growth": 0.23,
    "most_used_template": {
      "id": 789,
      "title": "Contrato Padr√£o",
      "usage_count": 5
    }
  },
  "recent_activity": [
    {
      "type": "document_created",
      "timestamp": "2024-01-20T14:30:00Z",
      "document_title": "Novo Contrato"
    }
  ]
}
```

## üîß Sistema e Monitoramento

### GET /health
Health check da aplica√ß√£o

**Response (200):**
```json
{
  "status": "healthy",
  "timestamp": "2024-01-20T16:00:00Z",
  "version": "1.0.0",
  "services": {
    "database": "connected",
    "redis": "connected",
    "ai_service": "available"
  },
  "metrics": {
    "response_time": 0.045,
    "memory_usage": "67%",
    "active_connections": 15
  }
}
```

### GET /cache/stats
Estat√≠sticas do cache (admin apenas)

**Response (200):**
```json
{
  "strategy": "hybrid",
  "hit_rate": 85.2,
  "total_requests": 1250,
  "cache_size": "45MB",
  "redis_status": "connected",
  "memory_keys": 145
}
```

## ‚ö†Ô∏è C√≥digos de Erro

### C√≥digos HTTP Padr√£o

| C√≥digo | Descri√ß√£o | Exemplo |
|---------|-----------|---------|
| 200 | Sucesso | Opera√ß√£o realizada com sucesso |
| 201 | Criado | Recurso criado com sucesso |
| 400 | Bad Request | Dados inv√°lidos na requisi√ß√£o |
| 401 | Unauthorized | Token inv√°lido ou expirado |
| 403 | Forbidden | Acesso negado ao recurso |
| 404 | Not Found | Recurso n√£o encontrado |
| 422 | Unprocessable Entity | Dados v√°lidos mas n√£o process√°veis |
| 429 | Too Many Requests | Rate limit excedido |
| 500 | Internal Server Error | Erro interno do servidor |

### Formato de Erro Padr√£o

```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Dados de entrada inv√°lidos",
    "details": {
      "field": "email",
      "issue": "Formato de email inv√°lido"
    },
    "timestamp": "2024-01-20T16:00:00Z",
    "request_id": "req_123456789"
  }
}
```

## üîí Rate Limiting

A API implementa rate limiting para proteger contra abuso:

| Endpoint | Limite | Janela |
|----------|--------|--------|
| `/auth/login` | 5 tentativas | 5 minutos |
| `/auth/register` | 3 registros | 1 hora |
| `/ai/*` | 20 requests | 1 hora |
| `/upload/*` | 10 uploads | 1 hora |
| Geral | 100 requests | 1 hora |

### Headers de Rate Limiting

```http
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1642694400
```

## üìù Changelog

### v1.0.0 (2024-01-20)
- Lan√ßamento inicial da API
- Funcionalidades b√°sicas de CRUD
- Integra√ß√£o com IA
- Sistema de templates avan√ßado
- Cache e performance otimizados
- Rate limiting implementado
- Documenta√ß√£o completa 